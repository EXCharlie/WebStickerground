(function(){"use strict";var e={7619:function(e,t,o){var n=o(5130),a=o(6768),l=o(4232),i=o(144),u=(o(4114),o(8111),o(116),o(1701),o(3574));const r=(0,i.KR)([]),s=(0,i.KR)(""),c=(0,i.KR)("#f0f0f0"),v=(0,i.KR)(!1),d=(0,i.KR)({x:0,y:0});function p(){const e=e=>{const t={x:window.innerWidth/2-125,y:window.innerHeight/2-125},o={id:(0,u.A)(),position:e.position||t,type:e.type,content:e.content,options:e.options||{}};r.value.push(o)},t=e=>{const t=e.stickers.map((e=>({...e,id:e.id||(0,u.A)()})));r.value=t,e.backgroundImageUrl&&(s.value=e.backgroundImageUrl),e.pageBackgroundColor&&(c.value=e.pageBackgroundColor),e.canvasPosition&&(d.value=e.canvasPosition)},o=()=>{const e={backgroundImageUrl:s.value,pageBackgroundColor:c.value,stickers:r.value,canvasPosition:d.value},t=JSON.stringify(e,null,2),o=new Blob([t],{type:"application/json"}),n=URL.createObjectURL(o),a=document.createElement("a");a.href=n,a.download="stickerground.json",a.click(),URL.revokeObjectURL(n)},n=(e,t)=>{const o=r.value.find((t=>t.id===e));o&&(o.position=t)},a=(e,t)=>{d.value.x+=e,d.value.y+=t},l=()=>{v.value=!v.value};return{stickers:r,backgroundImageUrl:s,pageBackgroundColor:c,isDraggable:v,canvasPosition:d,addSticker:e,loadStickers:t,exportStickers:o,updateStickerPosition:n,updateCanvasPosition:a,toggleDrag:l}}const k=["src","alt"],m={key:0},g={key:1,class:"quote-user-name"},h=["src"],f={class:"mark-time"},y={class:"mark-date"},b={class:"quote-user-name"};var L={__name:"StickerItem",props:{sticker:{type:Object,required:!0}},emits:["update-position"],setup(e,{emit:t}){const o=e,n=t,{isDraggable:u,canvasPosition:r}=p(),s=(0,i.KR)(null);(0,a.wB)((()=>o.sticker.position),(e=>{e&&(c.value={...e})}),{deep:!0});const c=(0,i.KR)({...o.sticker.position}),v=(0,i.KR)(!1),d=(0,i.KR)(1);let L=0,w=0;const C=e=>{if(!u.value||!s.value)return;v.value=!0,d.value=100;const t=s.value.getBoundingClientRect();L=e.clientX-t.left,w=e.clientY-t.top,window.addEventListener("mousemove",E),window.addEventListener("mouseup",R)},E=e=>{v.value&&(c.value.x=e.clientX-L-r.value.x,c.value.y=e.clientY-w-r.value.y)},R=()=>{v.value&&(v.value=!1,d.value=1,n("update-position",{id:o.sticker.id,position:c.value}),window.removeEventListener("mousemove",E),window.removeEventListener("mouseup",R))},X=e=>{if(!u.value||!s.value||1!==e.touches.length)return;v.value=!0,d.value=100;const t=s.value.getBoundingClientRect();L=e.touches[0].clientX-t.left,w=e.touches[0].clientY-t.top,window.addEventListener("touchmove",x,{passive:!1}),window.addEventListener("touchend",_),e.preventDefault()},x=e=>{v.value&&1===e.touches.length&&(c.value.x=e.touches[0].clientX-L-r.value.x,c.value.y=e.touches[0].clientY-w-r.value.y,e.preventDefault())},_=()=>{v.value&&(v.value=!1,d.value=1,n("update-position",{id:o.sticker.id,position:c.value}),window.removeEventListener("touchmove",x),window.removeEventListener("touchend",_))},K=(0,i.KR)(""),S=(0,i.KR)("");let U=null;if("timeNote"===o.sticker.type){const e=()=>{const e=new Date;K.value=e.toLocaleTimeString("en-US",{hour12:!1}),S.value=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric"}).format(e)};(0,a.sV)((()=>{e(),U=setInterval(e,1e3)})),(0,a.hi)((()=>{clearInterval(U)}))}const I=(0,a.EW)((()=>["sticker",o.sticker.type,o.sticker.options.customStyleName?`mark-${o.sticker.options.customStyleName}`:""])),N=(0,a.EW)((()=>({left:`${c.value.x}px`,top:`${c.value.y}px`,zIndex:d.value,cursor:u.value?"grab":"default",backgroundColor:o.sticker.options.backgroundColor,touchAction:"none"})));return(0,a.hi)((()=>{window.removeEventListener("mousemove",E),window.removeEventListener("mouseup",R),window.removeEventListener("touchmove",x),window.removeEventListener("touchend",_)})),(t,o)=>((0,a.uX)(),(0,a.CE)("div",{ref_key:"elementRef",ref:s,class:(0,l.C4)(I.value),style:(0,l.Tr)(N.value),onMousedown:C,onTouchstart:X},["note"===e.sticker.type?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.eW)((0,l.v_)(e.sticker.content),1)],64)):(0,a.Q3)("",!0),"imageNote"===e.sticker.type?((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[(0,a.Lk)("img",{src:e.sticker.content,alt:e.sticker.options.imageDescription,style:(0,l.Tr)({width:e.sticker.options.imageWidth,height:e.sticker.options.imageHeight||"auto"})},null,12,k),e.sticker.options.imageDescription?((0,a.uX)(),(0,a.CE)("p",m,(0,l.v_)(e.sticker.options.imageDescription),1)):(0,a.Q3)("",!0),e.sticker.options.userName?((0,a.uX)(),(0,a.CE)("div",g,"- "+(0,l.v_)(e.sticker.options.userName),1)):(0,a.Q3)("",!0)],64)):(0,a.Q3)("",!0),"imageSticker"===e.sticker.type?((0,a.uX)(),(0,a.CE)("img",{key:2,src:e.sticker.content,style:(0,l.Tr)({width:e.sticker.options.imageWidth,height:e.sticker.options.imageHeight||"auto"})},null,12,h)):(0,a.Q3)("",!0),"timeNote"===e.sticker.type?((0,a.uX)(),(0,a.CE)(a.FK,{key:3},[(0,a.Lk)("div",f,(0,l.v_)(K.value),1),(0,a.Lk)("div",y,(0,l.v_)(S.value),1)],64)):(0,a.Q3)("",!0),"quotenote"===e.sticker.type?((0,a.uX)(),(0,a.CE)(a.FK,{key:4},[(0,a.Lk)("div",null,(0,l.v_)(e.sticker.content),1),(0,a.Lk)("div",b,"- "+(0,l.v_)(e.sticker.options.userName),1)],64)):(0,a.Q3)("",!0)],38))}},w=o(1241);const C=(0,w.A)(L,[["__scopeId","data-v-e34350fe"]]);var E=C;const R={class:"modal-content"},X={key:0},x={key:2},_={key:4},K={key:6},S={key:8},U={key:10},I={class:"form-buttons"};var N={__name:"AddStickerModal",emits:["close"],setup(e,{emit:t}){const o=t,{addSticker:l}=p(),u=(0,i.KR)("note"),r=(0,i.KR)(""),s=(0,i.KR)("#ffffff"),c=(0,i.KR)(""),v=(0,i.KR)("200px"),d=(0,i.KR)(""),k=(0,i.KR)(""),m=()=>{if(!r.value&&("note"===u.value||u.value.startsWith("image")))return void alert("Content or Image URL is required.");const e={type:u.value,content:r.value,options:{backgroundColor:s.value,imageDescription:c.value,imageWidth:v.value,customStyleName:d.value,userName:k.value}};l(e),o("close")};return(e,t)=>((0,a.uX)(),(0,a.CE)("div",{class:"modal-overlay",onClick:t[8]||(t[8]=(0,n.D$)((e=>o("close")),["self"]))},[(0,a.Lk)("div",R,[t[12]||(t[12]=(0,a.Lk)("h2",null,"Create New Sticker",-1)),t[13]||(t[13]=(0,a.Lk)("div",{class:"feature-list"},[(0,a.Lk)("div",null,"This is for testing only and will not be saved to any server.")],-1)),(0,a.Lk)("form",{onSubmit:(0,n.D$)(m,["prevent"])},[t[11]||(t[11]=(0,a.Lk)("label",null,"Type:",-1)),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>u.value=e)},t[9]||(t[9]=[(0,a.Fv)('<option value="note" data-v-a2b7ccd0>Note</option><option value="timeNote" data-v-a2b7ccd0>Time Note</option><option value="imageNote" data-v-a2b7ccd0>Image Note</option><option value="imageSticker" data-v-a2b7ccd0>Image Sticker</option><option value="quotenote" data-v-a2b7ccd0>Quote Note</option>',5)]),512),[[n.u1,u.value]]),u.value.startsWith("image")?((0,a.uX)(),(0,a.CE)("label",X,"Image URL:")):(0,a.Q3)("",!0),u.value.startsWith("image")?(0,a.bo)(((0,a.uX)(),(0,a.CE)("input",{key:1,type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>r.value=e),placeholder:"e.g., /images/003.png"},null,512)),[[n.Jo,r.value]]):(0,a.Q3)("",!0),"note"===u.value?((0,a.uX)(),(0,a.CE)("label",x,"Content:")):(0,a.Q3)("",!0),"note"===u.value?(0,a.bo)(((0,a.uX)(),(0,a.CE)("textarea",{key:3,"onUpdate:modelValue":t[2]||(t[2]=e=>r.value=e),rows:"4"},null,512)),[[n.Jo,r.value]]):(0,a.Q3)("",!0),"quotenote"===u.value?((0,a.uX)(),(0,a.CE)("label",_,"Content:")):(0,a.Q3)("",!0),"quotenote"===u.value?(0,a.bo)(((0,a.uX)(),(0,a.CE)("textarea",{key:5,"onUpdate:modelValue":t[3]||(t[3]=e=>r.value=e),rows:"4"},null,512)),[[n.Jo,r.value]]):(0,a.Q3)("",!0),"quotenote"===u.value?((0,a.uX)(),(0,a.CE)("label",K,"User Name:")):(0,a.Q3)("",!0),"quotenote"===u.value?(0,a.bo)(((0,a.uX)(),(0,a.CE)("input",{key:7,type:"text","onUpdate:modelValue":t[4]||(t[4]=e=>k.value=e)},null,512)),[[n.Jo,k.value]]):(0,a.Q3)("",!0),"imageNote"===u.value?((0,a.uX)(),(0,a.CE)("label",S,"Image Description:")):(0,a.Q3)("",!0),"imageNote"===u.value?(0,a.bo)(((0,a.uX)(),(0,a.CE)("input",{key:9,type:"text","onUpdate:modelValue":t[5]||(t[5]=e=>c.value=e)},null,512)),[[n.Jo,c.value]]):(0,a.Q3)("",!0),"timeNote"!==u.value?((0,a.uX)(),(0,a.CE)("label",U,"Background Color:")):(0,a.Q3)("",!0),(0,a.bo)((0,a.Lk)("input",{type:"color","onUpdate:modelValue":t[6]||(t[6]=e=>s.value=e)},null,512),[[n.Jo,s.value]]),(0,a.Lk)("div",I,[(0,a.Lk)("button",{type:"button",onClick:t[7]||(t[7]=e=>o("close"))},"Cancel"),t[10]||(t[10]=(0,a.Lk)("button",{type:"submit"},"Create",-1))])],32)])]))}};const Q=(0,w.A)(N,[["__scopeId","data-v-a2b7ccd0"]]);var W=Q;const D={class:"modal-overlay"},B={class:"modal-content"},O={class:"setting-item-group"},T={class:"radio-options"},j={key:0,class:"setting-item"},P={key:1,class:"setting-item"},F={class:"setting-item"},V={class:"form-buttons"};var A={__name:"SettingsModal",emits:["close"],setup(e,{emit:t}){const o=t,{backgroundImageUrl:u,pageBackgroundColor:r,isDraggable:s,toggleDrag:c,exportStickers:v,loadStickers:d}=p(),k=(0,i.KR)(u.value?"image":"color");(0,a.wB)(u,(e=>{e&&(k.value="image")})),(0,a.wB)(r,(e=>{e&&!u.value&&(k.value="color")}));const m=()=>{u.value="",r.value="#f0f0f0",k.value="color"},g=()=>{const e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=e=>{const t=e.target.files[0];if(!t)return;const o=new FileReader;o.onload=e=>{try{const t=JSON.parse(e.target.result);d(t)}catch(t){alert("Import failed. Please check the file format."),console.error("Import Error:",t)}},o.readAsText(t)},e.click()},h=()=>{"color"===k.value?u.value="":"image"!==k.value||u.value||(r.value="#f0f0f0"),o("close")};return(e,t)=>((0,a.uX)(),(0,a.CE)("div",D,[(0,a.Lk)("div",B,[t[12]||(t[12]=(0,a.Lk)("h2",null,"Settings",-1)),(0,a.Lk)("div",O,[t[8]||(t[8]=(0,a.Lk)("label",null,"Background:",-1)),(0,a.Lk)("div",T,[(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{type:"radio",value:"image","onUpdate:modelValue":t[0]||(t[0]=e=>k.value=e)},null,512),[[n.XL,k.value]]),t[6]||(t[6]=(0,a.eW)(" Image URL "))]),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{type:"radio",value:"color","onUpdate:modelValue":t[1]||(t[1]=e=>k.value=e)},null,512),[[n.XL,k.value]]),t[7]||(t[7]=(0,a.eW)(" Color "))])])]),"image"===k.value?((0,a.uX)(),(0,a.CE)("div",j,[t[9]||(t[9]=(0,a.Lk)("label",null,"Image URL:",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>(0,i.i9)(u)?u.value=e:null),placeholder:"Enter image URL"},null,512),[[n.Jo,(0,i.R1)(u)]])])):(0,a.Q3)("",!0),"color"===k.value?((0,a.uX)(),(0,a.CE)("div",P,[t[10]||(t[10]=(0,a.Lk)("label",null,"Background Color:",-1)),(0,a.bo)((0,a.Lk)("input",{type:"color","onUpdate:modelValue":t[3]||(t[3]=e=>(0,i.i9)(r)?r.value=e:null)},null,512),[[n.Jo,(0,i.R1)(r)]])])):(0,a.Q3)("",!0),(0,a.Lk)("div",F,[t[11]||(t[11]=(0,a.Lk)("label",null,"Lock Stickers:",-1)),(0,a.Lk)("button",{class:"toggle-button",onClick:t[4]||(t[4]=(...e)=>(0,i.R1)(c)&&(0,i.R1)(c)(...e))},(0,l.v_)((0,i.R1)(s)?"Unlocked 🔓":"Locked 🔐"),1)]),(0,a.Lk)("div",V,[(0,a.Lk)("button",{onClick:m},"Clear Background"),(0,a.Lk)("button",{onClick:g},"Import"),(0,a.Lk)("button",{onClick:t[5]||(t[5]=(...e)=>(0,i.R1)(v)&&(0,i.R1)(v)(...e))},"Export"),(0,a.Lk)("button",{class:"primary",onClick:h},"Done")])])]))}};const q=(0,w.A)(A,[["__scopeId","data-v-283b4192"]]);var J=q;const Y={class:"nav"};var $={__name:"StickerToolbar",setup(e){const t=(0,i.KR)(!1),o=(0,i.KR)(!1);return(e,n)=>((0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("div",Y,[(0,a.Lk)("button",{onClick:n[0]||(n[0]=e=>t.value=!0),class:"nav-button"},"+"),(0,a.Lk)("button",{onClick:n[1]||(n[1]=e=>o.value=!0),class:"nav-button"},"⚙️")]),t.value?((0,a.uX)(),(0,a.Wv)(W,{key:0,onClose:n[2]||(n[2]=e=>t.value=!1)})):(0,a.Q3)("",!0),o.value?((0,a.uX)(),(0,a.Wv)(J,{key:1,onClose:n[3]||(n[3]=e=>o.value=!1)})):(0,a.Q3)("",!0)],64))}};const M=(0,w.A)($,[["__scopeId","data-v-0a2dab7e"]]);var H=M;const z={class:"modal-overlay"},G={class:"modal-content welcome-modal"};var Z={__name:"WelcomeModal",emits:["close"],setup(e,{emit:t}){const o=t;return(e,t)=>((0,a.uX)(),(0,a.CE)("div",z,[(0,a.Lk)("div",G,[t[1]||(t[1]=(0,a.Lk)("h2",null,"Welcome to Messagesground! 👋",-1)),t[2]||(t[2]=(0,a.Lk)("p",null,"Some people say that the holiday during the college entrance examination is the last dinner（最后的晚餐） for senior high school sophomores. Share your thoughts.",-1)),t[3]||(t[3]=(0,a.Lk)("div",{class:"feature-list"},[(0,a.Lk)("div",null,"👂 We listen,We don't judge."),(0,a.Lk)("div",null,"🌿 Keep harmonious words."),(0,a.Lk)("div",null,"📖 Leave some thoughts for our high school life."),(0,a.Lk)("div",null,"🌟 Share experience for school life.")],-1)),(0,a.Lk)("button",{class:"primary",onClick:t[0]||(t[0]=e=>o("close"))},"Got it!")])]))}};const ee=(0,w.A)(Z,[["__scopeId","data-v-01a2469e"]]);var te=ee;const oe={class:"app",title:"这是标题"};var ne={__name:"App",setup(e){const{stickers:t,backgroundImageUrl:o,pageBackgroundColor:n,canvasPosition:u,loadStickers:r,updateStickerPosition:s,updateCanvasPosition:c}=p(),v=(0,i.KR)(!0),d=(0,i.KR)(!1),k=(0,i.KR)({x:0,y:0}),m=({id:e,position:t})=>{s(e,{x:t.x,y:t.y})},g=(0,a.EW)((()=>({backgroundColor:n.value,backgroundImage:o.value?`url(${o.value})`:"none",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}))),h=e=>{"stickerground"===e.target.id&&(d.value=!0,k.value={x:e.clientX,y:e.clientY})},f=e=>{if(d.value){const t=e.clientX-k.value.x,o=e.clientY-k.value.y;c(t,o),k.value={x:e.clientX,y:e.clientY}}},y=()=>{d.value=!1},b=e=>{"stickerground"===e.target.id&&1===e.touches.length&&(d.value=!0,k.value={x:e.touches[0].clientX,y:e.touches[0].clientY},e.preventDefault())},L=e=>{if(d.value&&1===e.touches.length){const t=e.touches[0].clientX-k.value.x,o=e.touches[0].clientY-k.value.y;c(t,o),k.value={x:e.touches[0].clientX,y:e.touches[0].clientY},e.preventDefault()}},w=()=>{d.value=!1};(0,a.sV)((()=>{window.addEventListener("mousemove",f),window.addEventListener("mouseup",y),window.addEventListener("touchmove",L,{passive:!1}),window.addEventListener("touchend",w),fetch("/stickerground.json").then((e=>e.json())).then((e=>r(e))).catch((e=>console.error("Failed to load initial sticker data:",e))),v.value=!0})),(0,a.hi)((()=>{window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",y),window.removeEventListener("touchmove",L),window.removeEventListener("touchend",w)}));const C=(0,a.EW)((()=>({transform:`translate(${u.value.x}px, ${u.value.y}px)`,position:"absolute",top:0,left:0})));return(e,o)=>{const n=(0,a.gN)("title");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bo)((0,a.Lk)("div",oe,null,512),[[n]]),(0,a.Lk)("div",{id:"stickerground",style:(0,l.Tr)(g.value),onMousedown:h,onTouchstart:b},[(0,a.Lk)("div",{style:(0,l.Tr)(C.value)},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)((0,i.R1)(t),(e=>((0,a.uX)(),(0,a.Wv)(E,{key:e.id,sticker:e,onUpdatePosition:m},null,8,["sticker"])))),128))],4),(0,a.bF)(H),v.value?((0,a.uX)(),(0,a.Wv)(te,{key:0,onClose:o[0]||(o[0]=e=>v.value=!1)})):(0,a.Q3)("",!0)],36)],64)}}};const ae=ne;var le=ae;(0,n.Ef)(le).mount("#app")}},t={};function o(n){var a=t[n];if(void 0!==a)return a.exports;var l=t[n]={exports:{}};return e[n].call(l.exports,l,l.exports,o),l.exports}o.m=e,function(){var e=[];o.O=function(t,n,a,l){if(!n){var i=1/0;for(c=0;c<e.length;c++){n=e[c][0],a=e[c][1],l=e[c][2];for(var u=!0,r=0;r<n.length;r++)(!1&l||i>=l)&&Object.keys(o.O).every((function(e){return o.O[e](n[r])}))?n.splice(r--,1):(u=!1,l<i&&(i=l));if(u){e.splice(c--,1);var s=a();void 0!==s&&(t=s)}}return t}l=l||0;for(var c=e.length;c>0&&e[c-1][2]>l;c--)e[c]=e[c-1];e[c]=[n,a,l]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};o.O.j=function(t){return 0===e[t]};var t=function(t,n){var a,l,i=n[0],u=n[1],r=n[2],s=0;if(i.some((function(t){return 0!==e[t]}))){for(a in u)o.o(u,a)&&(o.m[a]=u[a]);if(r)var c=r(o)}for(t&&t(n);s<i.length;s++)l=i[s],o.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return o.O(c)},n=self["webpackChunkwebdemo"]=self["webpackChunkwebdemo"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=o.O(void 0,[504],(function(){return o(7619)}));n=o.O(n)})();
//# sourceMappingURL=app.fa9d137a.js.map